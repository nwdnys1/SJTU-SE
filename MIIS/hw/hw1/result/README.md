## RPA 流程自动化实现大作业

FBS 图表与其他文档请查看根目录下的./docs/文件夹

### 一、小组信息

| 姓名   | 学号         | 分工情况          | 贡献比例 |
| ------ | ------------ | ----------------- | -------- |
| 赵楷越 | 522031910803 | 代码编写+文档编写 | 50%      |
| 朱涵   | 522031910213 | 代码编写+视频剪辑 | 50%      |

### 二、主要技术

- 项目使用了 java、python、shell 等多种语言 结合了 tagUI 工具进行流程自动化的实现
- python：主要用于 OCR 技术的使用 将图片中的有效信息提取到 json 格式的文件中 等待下一步的处理
- java：主要用于对 json 格式的发票数据进行处理审批和存储计算 包括以下几个模块
  - 解析 json 文件 转换为 java 对象
  - 对发票数据进行审批并上传通过审批的发票至图床
  - 对发票数据进行统计处理 收集财务关系信息并转换为 json 格式数据
  - 使用加权算法对于财务关系信息进行计算 得到有效的数据处理结果
  - 将原始数据与处理结果存储到关系型数据库中
- batch：主要用于流程的自动化执行 通过调用 java 和 python 的程序以及 tagUI 工具实现流程的自动化
- tagUI：主要用于 excel 文件的读取和写入 以及对于网页的操作来实现邮件的发送

### 三、数据结构

1. customer 表
   | 字段 | 类型 | 说明 |
   |------------|-----------------|------------------|
   | id | int(11) | 主键，自增 |
   | amount | int(11) | 余额 |
   | count | int(11) | 计数 |
   | name | varchar(255) | 客户名称 |
   | score | double | 客户得分 |
   | type | varchar(255) | 类型 |

2. frequency 表
   | 字段 | 类型 | 说明 |
   |------------|-----------------|-------------------|
   | id | int(11) | 主键，自增 |
   | freq | int(11) | 频率 |
   | cid | int(11) | 外键，指向 customer.id |
   | sid | int(11) | 外键，指向 supplier.id |

3. invoice 表
   | 字段 | 类型 | 说明 |
   |------------|-----------------|-------------------|
   | id | int(11) | 主键，自增 |
   | amount | int(11) | 金额 |
   | date | date | 日期 |
   | file_name| varchar(255) | 文件名 |
   | image_uri| varchar(255) | 图片路径 |
   | number | varchar(255) | 发票编号 |
   | remark | varchar(255) | 备注 |
   | status | int(11) | 状态 |
   | cid | int(11) | 外键，指向 customer.id |
   | sid | int(11) | 外键，指向 supplier.id |

4. non_invoice 表
   | 字段 | 类型 | 说明 |
   |------------|-----------------|------------------|
   | id | int(11) | 主键，自增 |
   | file_name| varchar(255) | 文件名 |
   | image_uri| varchar(255) | 图片路径 |

5. supplier 表
   | 字段 | 类型 | 说明 |
   |------------|-----------------|-------------------|
   | id | int(11) | 主键，自增 |
   | amount | int(11) | 余额 |
   | count | int(11) | 计数 |
   | name | varchar(255) | 供应商名称 |
   | score | double | 供应商得分 |
   | type | varchar(255) | 类型 |

### 四、创新点

1. **多语言协同开发**：项目结合了 Java、Python、Shell 等多种编程语言，并将其优势互补，形成高效的自动化处理流程。Python 用于图像识别和数据提取，Java 则用于复杂的数据处理和业务逻辑，Shell 和 TagUI 用于自动化流程和操作界面，最大化地提高了系统的灵活性和效率。

2. **OCR 与数据处理的结合**：项目创新性地将 OCR 技术与后续的数据处理流程深度集成。通过 Python 提取发票图片中的有效信息，并转化为 JSON 格式后交由 Java 进行进一步的审批、统计和计算，优化了发票数据的自动化处理链路。

3. **智能审批与上传机制**：采用自动化审批流程和发票上传至图床的机制，减少了人工审核的复杂性，提升了发票处理的效率和准确性，避免了人工操作的繁琐和错误。

4. **加权算法优化财务数据计算**：项目设计了一个加权算法来对财务关系信息进行计算，从而得到更为精准的财务分析结果。通过智能化计算，帮助企业更好地管理和优化财务数据。

5. **基于 TagUI 的 UI 自动化与数据交互**：使用 TagUI 工具实现了对于 Excel 文件的自动化处理和邮件发送，同时也可以对网页操作进行自动化，进一步优化了数据处理的全流程，提升了用户交互的自动化水平。

6. **自动化流程**：通过将 Java、Python、Shell 和 TagUI 等技术工具结合，创建了一个自动化的流程，涵盖了从 OCR 识别到数据处理、审批、上传、存储和统计的各个环节，确保了数据处理的全自动化和高效性。

### 五、演示视频

见根目录下的视频文件

### 六、说明文档

#### 环境配置

```shell
conda create -n rpa python=3.9.20
conda activate rpa
pip install -r requirements.txt
```

- 同时需将 7z.exe 添加到系统的环境变量中

#### 运行方式

```shell
cd ./flows/work/
start.bat
```
